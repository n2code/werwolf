<!DOCTYPE html>
<html manifest="werwolf.appcache" lang="de">
	<!--@ Nikos Werwolf-Spielleiter-Web-App auf http://n2code.github.io/werwolf -->
	<head>
		<meta name="HandheldFriendly" content="true"/>
	    <meta name="MobileOptimized" content="320"/>
		<meta name="viewport" content="width=320,initial-scale=1.0,target-densityDpi=145"/>
		<meta name="apple-mobile-web-app-capable" content="yes"/>
		<meta charset="utf-8"/>
		<title>Werwolf-Spielleiter-Web-App</title>
		<style>
			/* CSS-Reset */
			html, body, div, span, applet, object, iframe,
			h1, h2, h3, h4, h5, h6, p, blockquote, pre,
			a, abbr, acronym, address, big, cite, code,
			del, dfn, em, font, img, ins, kbd, q, s, samp,
			small, strike, strong, sub, sup, tt, var,
			dl, dt, dd, ol, ul, li,
			 form, label, legend,
			table, caption, tbody, tfoot, thead, tr, th, td {
				margin: 0;
				padding: 0;
				border: 0;
				outline: 0;
				font-weight: inherit;
				font-style: inherit;
				font-size: 100%;
				font-family: inherit;
				vertical-align: baseline;
			}
			:focus {
				outline: 0;
			}
			body {
				line-height: 1;
				color: black;
				background: white;
			}
			ol, ul {
				list-style: none;
			}
			table {
				border-collapse: separate;
				border-spacing: 0;
			}
			caption, th, td {
				text-align: left;
				font-weight: normal;
			}
			blockquote:before, blockquote:after,
			q:before, q:after {
				content: "";
			}
			blockquote, q {
				quotes: "" "";
			}
			/* ENDE CSS Reset */
			body
			{
				font: 20px verdana, sans-serif;
				width:320px;
				-moz-user-select: -moz-none;
				-khtml-user-select: none;
				-webkit-user-select: none;
				-ms-user-select: none;
				user-select: none;
			}
			h1
			{
				color: #555555;
				font-weight: bold;
				text-shadow: 0 -1px 1px #000000;
				text-align: center;
				margin: 0px 0px 3px 0px;
				font-size:1.2em;
				font-weight:bold;
				font-variant:small-caps;
			}
			h2
			{
				text-align: right;
				margin-top:0px;
				color:#555555;
				font-size:1.3em;
				font-weight:bold;
				font-variant:small-caps;
			}
			h3
			{
				text-align: left;
				margin-top:0px;
				color:#666666;
				font-size:1.0em;
				font-weight:bold;
				font-variant:small-caps;
			}
			fieldset
			{
				border:7px solid #999999;
				border-radius:15px;
				border-radius:15px;
				background-color:#f0f8ff;
				padding:5px;
				padding-top:0px;
				margin-bottom:10px;
				margin-left:0px;
				margin-right:0px;
			}
			hr
			{
				width:95%;
				border:2px solid #999999;
			}
			select
			{
				border: 2px solid #AAAAAA;
				padding: 4px 3px 3px 5px;
				margin: 0;
				font: inherit;
				outline:none;
				line-height: 1.1;
				background: #DDDDDD;
				-webkit-appearance:none;
				border-radius: 10px;
			}
			ul
			{
				border: 2px solid #bbb;
				box-shadow: 5px 5px 5px #888;
				margin: 3px 10px 10px 3px;
				background-color:#CCCCCC;
				width:278px;
			}
			ol
			{
				list-style-type: decimal;
			}
			li
			{
				margin: 3px 3px 3px 3px;
				padding: 2px 2px 2px 2px;
				background-color:#EEEEEE;
				overflow:hidden;
			}
			#spielerliste>li, #rollenliste>li, #auswahlanzeige>li
			{
				line-height:36px;
				min-height:36px;
			}
			#ausgabeeinstellungen
			{
				text-align: center;
			}
			#ausgabeeinstellungen > p
			{
				font-size: 0.8em;
				text-align: left;
			}
			#ausgabeeinstellungen > hr
			{
				width:90%;
				border:1px solid #CCCCCC;
			}
			button.blaubutton
			{
				font: inherit;
			    font-weight: bold;
				text-shadow: -1px -1px  3px #666666;
				color: #FFFFFF;

				-webkit-border-radius: 15px;
				-moz-border-radius: 15px;
				border-radius: 15px;
				border: 1px solid #CCCCCC;
				padding: 10px 15px;

				background: rgb(101,175,232);
				background: -moz-linear-gradient(top, rgba(101,175,232,1) 0%, rgba(49,113,193,1) 100%);
				background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(101,175,232,1)), color-stop(100%,rgba(49,113,193,1)));
				background: -webkit-linear-gradient(top, rgba(101,175,232,1) 0%,rgba(49,113,193,1) 100%);
				background: -o-linear-gradient(top, rgba(101,175,232,1) 0%,rgba(49,113,193,1) 100%);
				background: -ms-linear-gradient(top, rgba(101,175,232,1) 0%,rgba(49,113,193,1) 100%);
				background: linear-gradient(top, rgba(101,175,232,1) 0%,rgba(49,113,193,1) 100%);
				filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#65afe8', endColorstr='#3171c1',GradientType=0 );
			}
			button.blaubutton:hover, button.blaubutton:focus
			{
				text-shadow: -1px -2px  4px #FF0000;
			}
			button.menubutton
			{
				width:190px;
				margin: 7px 0px 7px 0px;
			}
			button.listenbutton
			{
				
				float:right;
				height:48px;
				width:48px;
				
				font: inherit;
				font-weight:bold;
				font-size:0.8em;
				text-shadow: 1px -1px  1px #FFFFFF;
				color:#000;

				-webkit-border-radius: 5px;
				-moz-border-radius: 5px;
				border-radius: 5px;
				border: 1px solid #CCCCCC;
				padding: 2px 4px 4px 4px;

				background: rgb(188,188,188);
				background: -moz-linear-gradient(top, rgba(188,188,188,1) 0%, rgba(229,229,229,1) 5%, rgba(179,179,179,1) 58%, rgba(179,179,179,1) 100%);
				background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(188,188,188,1)), color-stop(5%,rgba(229,229,229,1)), color-stop(58%,rgba(179,179,179,1)), color-stop(100%,rgba(179,179,179,1)));
				background: -webkit-linear-gradient(top, rgba(188,188,188,1) 0%,rgba(229,229,229,1) 5%,rgba(179,179,179,1) 58%,rgba(179,179,179,1) 100%);
				background: -o-linear-gradient(top, rgba(188,188,188,1) 0%,rgba(229,229,229,1) 5%,rgba(179,179,179,1) 58%,rgba(179,179,179,1) 100%);
				background: -ms-linear-gradient(top, rgba(188,188,188,1) 0%,rgba(229,229,229,1) 5%,rgba(179,179,179,1) 58%,rgba(179,179,179,1) 100%);
				background: linear-gradient(top, rgba(188,188,188,1) 0%,rgba(229,229,229,1) 5%,rgba(179,179,179,1) 58%,rgba(179,179,179,1) 100%);
				filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#bcbcbc', endColorstr='#b3b3b3',GradientType=0 );
			}
			button.menulistenbutton
			{
				float:none;
				height:auto;
				width:170px;
				margin-bottom:5px;
			}
			button.listenbutton:hover, button.listenbutton:focus
			{
				text-shadow: 1px -1px  1px #6495ED;
				border: 1px solid #6495ED;
			}
			button.listenbutton>img
			{
				width:40px;
				height:40px;
			}
			#bugbutton
			{
				width:250px;
			}
			#continuebutton
			{
				display:none;
			}
			#continuebutton>button
			{
				font-variant:small-caps;
				font-weight:bold;
				color:#00EE00;
			}
			#spielername
			{
				font: inherit;
				width:210px;
				height:36px;
			}
			#rollenselect
			{
				width:100%;
			}
			#spielerauswahl
			{
				width:180px;
			}
			.zentriermich
			{
				text-align: center;
			}
			.jabutton
			{
				float:left;
			}
			.neinbutton
			{
				float:right;
			}
			.einstellungsauswahl
			{
				padding: 2px 2px 2px 2px;
				margin: 1px 1px 1px 1px;
				border-radius: 5px;
			}
			.status_boese
			{
				border-style:none solid;
				border-width: 2px;
				border-color: #C00000;
			}
			.status_gut
			{
				border-style:none solid;
				border-width: 2px;
				border-color: #00BB00;
			}
			.status_tot
			{
				text-decoration: line-through;
				background-color: #999999;
			}
			span.status_klassentext
			{
				float:right;
				font-size:0.8em;
				font-variant:small-caps;
				vertical-align:bottom;
			}
			span.status_klassentext:before { content:"("; }
			span.status_klassentext:after  { content:")"; }
			q
			{
				display:block;
				quotes: "\00BB" "\00AB" "\203A" "2039";
				font-style:italic;
				font-family:times;
				font-size:1.2em;
			}
			q:before
			{
				content: open-quote;
			}
			q:after
			{
				content: close-quote;
			}
			#karte
			{
				background-color: white;
				display: inline-block;
				border: 5px solid black;
				width: 180px;
				height: 200px;
				border-radius:15px;
				box-shadow: 5px 5px 5px #888;
				padding: 20px 10px 20px 10px;
				text-align:center;
			}
			#kartenvergabe_spieler
			{
				font-size:1.2em;
			}
			.kontaktmail {
				unicode-bidi:bidi-override; direction: rtl;
				font-style:italic;
			}
			</style>
		<script>
			/* Variablen- und Grundsetup */
			var version = "V1.2-20230325-RC13";
			var speicherversion = 1;
			var speicherstand;
			var running = false;
			var schrittuhr_intervall, schrittuhr_sek;
			var kartenliste;
			//folgendes wird auch gespeichert:
			var leute, rollen, rids, einstellungen;
			var spieleranzahl, rollenanzahl, tagzahl, nachtzahl;
			var leutesammler, auswahl, entscheidung;
			var cphase, crolle, cschritt;
			var Tagesaktionen, SpielerToeten, TagLynchen; //TagLynchen scheint eine Karteileiche zu sein :/
			
			window.addEventListener('load', function(e) {
				document.getElementById('vinfo').innerHTML = version;
				window.applicationCache.update();
				window.applicationCache.addEventListener('updateready', function(e) {
					if (window.applicationCache.status == window.applicationCache.UPDATEREADY) {
						window.applicationCache.swapCache();
						if (!spielstand_vorhanden() && confirm("Ein Update f√ºr die WebApp ist vorhanden - Seite neu laden und es aktivieren?"))
						{
							document.location.reload();
						}
					}
				}, false);
			}, false);
			
			window.onbeforeunload = function(e) {
				if (running)
				{
					var msg = 'WebApp wirklich beenden?';
					e.returnValue = msg;
					return msg;
				}
			}
			
			/* Klassendefinitionen und -funktionen */
			function rolle()
			{
				this.rolleID = rollen.length;
				//AUTO, ID und Arrayindex

				this.name = "Neue Rolle"; //Bezeichnung
				this.strid = "neu"; //kurzer Bezeichnungsstring
				//werden durch Rollendefinition gesetzt
				
				this.imspiel = false; //Ist moeglicherweise im Spiel
				//relevant bei Rollen > Spieler, gibt an ob Karte im Pot war und sie jemand haben k√∂nnte
				
				this.notiert = false; //wurden einmalig aufgerufen zur Bestimmung
				//System kennt alle Spieler dieser Rolle?
				
				this.erwacht = true; //erwacht in der Nacht = wird aufgerufen
				//default true zur erstmaligen Notation, danach oder falls nur Aktion in erster Nacht -> false
				
				this.funktion_nacht = false; //Funktion, welche beim Aufruf bei Nacht ausgef√ºhrt wird
				//wird in jedem Schritt einer Rolle aufgerufen
				
				this.balance = 0; //Bewertung zur Spielbalance
				//Spielbalance zur groben Orientierung der Ausgewogenheit Gut<->B√∂se
				
				this.bekannt = 0; //√ñffentlich bekannte gestorbene Rollenbesitzer
				//bei Tag gestorbene werden ggf. hier gez√§hlt
				
				this.istboese = false; //Parteizugeh√∂rigkeit
				//ist die Rolle als b√∂se Partei zu bewerten
				
				this.einzelrolle = true; //Ein-Spieler-Rolle
				//darf nur 1 Spieler diese Rolle innehaben oder mehrere (false = Parteienrolle)
				
				this.anzahl = 0; //wieviele haben diese Rolle inne
				//GEHEIM, wieviele gibt es wirklich von einer Rolle
				this.lebende = 0; //wieviele noch leben
				//GEHEIM, wieviele davon leben
				this.spieler = new Array();
				//GEHEIM, Sammlung der Spieler-IDs mit dieser Rolle
				this.werte = new Object();
				//GEHEIM, Sondereigenschaften, rollenspezifisch
			}
			function spieler()
			{
				this.spielerID = leute.length;
				//AUTO, ID und Arrayindex
				
				this.name = "Neuer Spieler";
				//Bildschirmname
				
				this.rolle = -1;
				//Rolle, nichts = -1
				
				this.lebt = true;
				//eindeutig
				
				this.verstummt = false; //verstummt
				//darf nicht: reden, abstimmen, sich verteidigen
				
				this.waehlbar = true; //lynchbar, ernennbar ...
				//darf fuer irgendetwas gewaehlt werden
			}
			function NeueRolle(eigenschaften)
			{
				var neu = new rolle();
				for (var schluessel in eigenschaften)
				{
					neu[schluessel] = eigenschaften[schluessel];
				}
				rids[eigenschaften["strid"]] = rollen.length;
				rollen.push(neu);
			}
			function NeuerSpieler(eigenschaften)
			{
				var neu = new spieler();
				for (var schluessel in eigenschaften)
				{
					neu[schluessel] = eigenschaften[schluessel];
				}
				leute.push(neu);
			}
			function NeueEinstellung(setid, setwert, settext)
			{
				einstellungen[setid] = new Object();
				einstellungen[setid].id = setid;
				einstellungen[setid].wert = setwert;
				einstellungen[setid].text = settext;
			}
			
			/* Erweiterungsfunktionen */
			function contains(a, obj)
			{
				for (var i = 0; i < a.length; i++) {
					if (a[i] == obj) {
						return true;
					}
				}
				return false;
			}
			if (!String.prototype.trim)
			{
			  String.prototype.trim = function (){return this.replace(/^\s+|\s+$/g,'');};  
			}			
			function striptags(html)
			{
				var tmp = document.createElement("DIV");
				tmp.innerHTML = html;
				return tmp.textContent || tmp.innerText;
			}
			function supports_html5_storage() {
				try {
					return 'localStorage' in window && window['localStorage'] !== null;
				} catch (e) {
					return false;
				}
			}
			function spielstand_vorhanden()
			{
				if (supports_html5_storage() && (typeof localStorage.NWWA_Speicherstand !== 'undefined') && localStorage.NWWA_Speicherstand) return true;
				return false;
			}
			
			/* Spielfunktionen */
			function ErstelleSpeicherstand()
			{
				var savegame = new Object();
				savegame.version = version; //wichtig zum Abgleich beim Laden!
				savegame.speicherversion = speicherversion; //wichtig zum Abgleich beim Laden!
				savegame.leute = leute;
				savegame.rollen = rollen;
				savegame.rids = rids;
				savegame.einstellungen = einstellungen;
				savegame.spieleranzahl = spieleranzahl;
				savegame.rollenanzahl = rollenanzahl;
				savegame.tagzahl = tagzahl;
				savegame.nachtzahl = nachtzahl;
				savegame.leutesammler = leutesammler;
				savegame.auswahl = auswahl;
				savegame.entscheidung = entscheidung;
				savegame.cphase = cphase;
				savegame.crolle = crolle;
				savegame.cschritt = cschritt;
				savegame.Tagesaktionen = Tagesaktionen;
				savegame.SpielerToeten = SpielerToeten;
				savegame.TagLynchen = TagLynchen;
				var jsonsavegame = JSON.stringify(savegame, function (key, value) {
															if (typeof value === 'function') {
																return "jsonfunc:"+value.toString();
															}
															return value;
														});
				return jsonsavegame;
			}
			function LadeSpeicherstand(jsonsavegame)
			{
				var savegame = JSON.parse(jsonsavegame, function (key, value) {
									if (value && typeof value === "string" && value.substring(0,9)=="jsonfunc:")
									{
										var startBody = value.indexOf('{') + 1;
										var endBody = value.lastIndexOf('}');
										var startArgs = value.indexOf('(') + 1;
										var endArgs = value.indexOf(')');
										return new Function(value.substring(startArgs, endArgs), value.substring(startBody, endBody));
									}
									return value;
								});
				if (savegame.speicherversion!=speicherversion)
				{
					Anzeige_Hinweis('WARNUNG: Seit dem Speichern dieses Spiels gab es ein Update. Der Speicherstand ist mit der aktuellen Version vielleicht nicht kompatibel. Weiterspielen auf eigene Gefahr ;)');
					return false;
				}
				leute = savegame.leute;
				rollen = savegame.rollen;
				rids = savegame.rids;
				einstellungen = savegame.einstellungen;
				spieleranzahl = savegame.spieleranzahl;
				rollenanzahl = savegame.rollenanzahl;
				tagzahl = savegame.tagzahl;
				nachtzahl = savegame.nachtzahl;
				leutesammler = savegame.leutesammler;
				auswahl = savegame.auswahl;
				entscheidung = savegame.entscheidung;
				cphase = savegame.cphase;
				crolle = savegame.crolle;
				cschritt = savegame.cschritt;
				Tagesaktionen = savegame.Tagesaktionen;
				SpielerToeten = savegame.SpielerToeten;
				TagLynchen = savegame.TagLynchen;
				return true;
			}
			
			function SpielInit()
			{
				leutesammler = new Array();
				spieleranzahl = 0;
				SpielReset();

				/* Einstellungen */
				einstellungen = new Object();
				//NeueEinstellung("dummysetting",true,"Ausf√ºhrlicher Text");

				NeueEinstellung("hexe_eigenschutz",false,"Hexe darf sich selbst sch√ºtzen");
				NeueEinstellung("amor_eigenwahl",true,"Amor darf sich selbst verkuppeln");
				NeueEinstellung("leibwaechter_eigenwahl",true,"Nachtw√§chter / Priester darf sich selbst sch√ºtzen");
				NeueEinstellung("rolle_verliebt_bekanntgeben",true,"Beim Suizid aus Liebe wird bei Tag die Rolle bekanntgegeben");
				NeueEinstellung("rolle_lynchen_bekanntgeben",true,"Beim Lynchen wird die Rolle des Verstorbenen bekanntgegeben");
				NeueEinstellung("rollen_anzahlen_bekannt",true,"Anzahlen der Spieler pro Rolle bekannt");
				NeueEinstellung("rolle_tot_zugeben",false,"Zugeben, sobald eine Rolle ausgel√∂scht worden ist (nicht empfohlen)");

				NeueEinstellung("text_vorsicht_tot"," (Rolle ist bereits tot - warte eine Weile, um dies zu verschleiern)","Hilfstext");
				NeueEinstellung("text_vorsicht_aktionslos"," (keine Aktion m√∂glich - warte eine Weile, um dies zu verschleiern)","Hilfstext");
				
				Anzeige_Menu(['spiel_hauptmenu']);
			}
			
			function SpielReset()
			{
				window.scrollTo(0,1);
				leute = new Array(); //Array mit allen Spielerobjekten
				rollen = new Array(); //Array mit allen Rollenobjekten
				rids = new Object(); //Eigenschaften beinhalten Rollen-ID: rids["werwolf"] liefert Index von rollen-Array
				rollenanzahl = 0;
				
				/*
				Kurzanleitung - Implementierung einer neuen Rolle:
				-> Rolle mit NeueRolle() anlegen, dabei wegen Interaktion mit anderen Rollen auf Reihenfolge achten
				-> in Tagesaktionen() Tode bzw. Tagesnachrichten durch Rolle ausl√∂sen lassen
				-> in SpielerToeten() ggf. Todesverhinderung oder Sondertod durch/bei Rolle erg√§nzen
				*/
				
				/* Rollendefinitionen */
				//Eingebaut (in Reihenfolge): Amor, G√ºnstling, Werw√∂lfe, Nachtw√§chter / Priester, Alte Vettel, Hexe, Verfluchter, Seher, Prinz, Harter Bursche, Dorfbewohner
				NeueRolle({name:"Amor",strid:"amor",
							balance:-3,
							funktion_nacht:function()
							{
								if (!rollen[crolle].notiert)
								{
									switch (cschritt)
									{
										case 0:
											cschritt++;
											Anzeige_Auswahl("<q><b>Amor</b> erwacht. Er wird gleich zwei Spieler ineinander verlieben. Die Verliebten kennen einander und begehen sofort Suizid, sollte ihr Partner sterben.</q> <b>(Amor erfassen falls vorhanden)</b>",function(spieler){return HatKeineRolle(spieler);});
											break;
										case 1:
											if (Check_Auswahl(0,1,false))
											{
												if (auswahl.length>0)
												{
													rollen[crolle].spieler = auswahl;
													RollenUebertragen(crolle);
												}
												cschritt = 0;
												rollen[crolle].notiert = true;
											}
											break;
									}
								}
								if (rollen[crolle].notiert)
								{
									if (!IstRolleAufzurufen(crolle))
									{
										cschritt = 4;
									}
									switch (cschritt)
									{
										case 0:
											cschritt++;
											var rollentext = "<q><b>Welche zwei Spieler</b> m√∂chte Amor verlieben? (gleichgeschlechtliche Beziehungen sind auch erlaubt, Eigenwahl "+(einstellungen["amor_eigenwahl"].wert?"erlaubt":"verboten")+")</q>";
											rollen[crolle].werte.verliebte = new Array();
											if (IstRolleInaktiv(crolle))
											{
												cschritt++;
												Anzeige_Notiz(rollentext+einstellungen["text_vorsicht_tot"].wert);
											}
											else
											{
												Anzeige_Auswahl(rollentext,function(spieler){if (einstellungen["amor_eigenwahl"].wert?true:spieler.rolle!=rids["amor"]) {return true;} else return false;});
											}
											break;
										case 1:
											if (Check_Auswahl(2,2,false))
											{
												rollen[crolle].werte.verliebte.push(auswahl[0],auswahl[1]);
												cschritt++;
												Schritt();
											}
											break;
										case 2:
											cschritt++;
											Anzeige_Notiz("<q>Amor hat seine Wahl getroffen und schl√§ft wieder ein.</q>");
											break;
										case 3:
											cschritt++;
											var verliebte = leute[rollen[crolle].werte.verliebte[0]].name+" und "+leute[rollen[crolle].werte.verliebte[1]].name;
											var rollentext = "<q>Die Verliebten werden nun angetippt.</q><b>(Einmal um die Runde laufen und die beiden Verliebten leise antippen: "+verliebte+")</b><q>Sie erwachen und erkennen wie unsterblich verliebt ineinander sie doch sind. Anschlie√üend schlafen sie wieder ein.</q>";
											Anzeige_Notiz(rollentext+(IstRolleInaktiv(crolle)?einstellungen["text_vorsicht_tot"].wert:""));
											break;
										case 4:
											rollen[crolle].erwacht = false;
											RolleEnde();
											break;
									}
								}
							},
							});
				NeueRolle({name:"G√ºnstling",strid:"guenstling",
							balance:-6,
							istboese:true,
							funktion_nacht:function()
							{
								if (!rollen[crolle].notiert)
								{
									switch (cschritt)
									{
										case 0:
											cschritt++;
											Anzeige_Auswahl("<q>Der <b>G√ºnstling</b> erwacht. Er steht auf der Seite der Werw√∂lfe, verwandelt sich aber nicht und wird daher vom Seher auch nicht als Feind erkannt.</q> <b>(G√ºnstling erfassen falls vorhanden)</b>",function(spieler){return HatKeineRolle(spieler);});
											break;
										case 1:
											if (Check_Auswahl(0,1,false))
											{
												if (auswahl.length>0)
												{
													rollen[crolle].spieler = auswahl;
													RollenUebertragen(crolle);
												}
												cschritt = 0;
												rollen[crolle].notiert = true;
											}
											break;
									}
								}
								if (rollen[crolle].notiert)
								{
									switch (cschritt)
									{
										case 0:
											cschritt++;
											Anzeige_Notiz("<q>Zus√§tzlich erwachen nun alle Werw√∂lfe und der G√ºnstling gibt sich ihnen zu erkennen (z.b. durch Winken).</q>"+(rollen[crolle].spieler.length==0?"<b>(Signalisiere den W√∂lfen, dass es keinen G√ºnstling gibt!)</b>":"")+"<q>Anschlie√üend schlafen alle wieder ein.</q>");
											break;
										case 1:
											rollen[crolle].erwacht = false;
											RolleEnde();
											break;
									}
								}
							},
							});
				NeueRolle({name:"Werw√∂lfe",strid:"werwolf",
							balance:-6,
							istboese:true,
							einzelrolle:false,
							funktion_nacht:function()
							{
								if (!rollen[crolle].notiert)
								{
									switch (cschritt)
									{
										case 0:
											cschritt++;
											Anzeige_Auswahl("<q>Alle <b>Werw√∂lfe erwachen und erkennen sich gegenseitig</b>. Ihre Mission ist es, alle Dorfbewohner zu rei√üen, um siegreich aus dem Spiel hervorzugehen.</q>",function(spieler){return HatKeineRolle(spieler);});
											break;
										case 1:
											if (Check_Auswahl(0,-1,true))
											{
												if (auswahl.length>0)
												{
													rollen[crolle].spieler = auswahl;
													RollenUebertragen(crolle);
												}
												cschritt = 0;
												rollen[crolle].notiert = true;
											}
											break;
									}
								}
								if (rollen[crolle].notiert)
								{
									var zusatzwolf = ((rollen[rids["verfluchter"]].anzahl>0) && (rollen[rids["verfluchter"]].werte.istwolf));
									if (!IstRolleAufzurufen(crolle) && (!zusatzwolf))
									{
										cschritt = 3;
									}
									switch (cschritt)
									{
										case 0:
											cschritt++;
											Anzeige_Auswahl("<q>Mitten in der Nacht gehen die Werw√∂lfe auf die Jagd.</q><q>Sie einigen sich auf ihr <b>n√§chstes Opfer</b>...</q>",function(spieler){if (spieler.lebt) {return true;} else return false;});
											break;
										case 1:
											if (Check_Auswahl(0,1,true))
											{
												rollen[crolle].werte.ziele = new Array();
												for (var i in auswahl)
												{
													rollen[crolle].werte.ziele.push(auswahl[i]);
												}
												cschritt++;
												Schritt();
											}
											break;
										case 2:
											cschritt++;
											Anzeige_Notiz("<q>Die Werw√∂lfe haben ihre Wahl getroffen und schlafen wieder ein.</q>");
											break;
										case 3:
											RolleEnde();
											break;
									}
								}
							},
							});
				NeueRolle({name:"Nachtw√§chter / Priester",strid:"leibwaechter",
							balance:+3,
							funktion_nacht:function()
							{
								if (!rollen[crolle].notiert)
								{
									switch (cschritt)
									{
										case 0:
											cschritt++;
											rollen[crolle].werte.ziel = -1;
											rollen[crolle].werte.letztes_ziel = -1;
											Anzeige_Auswahl("<q>Der <b>Nachtw√§chter / Priester</b> kann jede Nacht einen anderen zu besch√ºtzenden Spieler w√§hlen, welcher dann in dieser Nacht durch nichts get√∂tet oder verletzt werden kann.</q> <b>(Nachtw√§chter / Priester erfassen falls vorhanden)</b>",function(spieler){return HatKeineRolle(spieler);});
											break;
										case 1:
											if (Check_Auswahl(0,1,false))
											{
												if (auswahl.length>0)
												{
													rollen[crolle].spieler = auswahl;
													RollenUebertragen(crolle);
												}
												cschritt = 0;
												rollen[crolle].notiert = true;
											}
											break;
									}
								}
								if (rollen[crolle].notiert)
								{
									if (!IstRolleAufzurufen(crolle))
									{
										rollen[crolle].werte.ziel = -1;
										cschritt = 2;
									}
									switch (cschritt)
									{
										case 0:
											cschritt++;
											var rollentext = "<q>Der Nachtw√§chter / Priester erwacht. <b>Wen</b> m√∂chte er in dieser Nacht besch√ºtzen? (nicht zweimal hintereinander dieselbe Person, Eigenwahl "+(einstellungen["leibwaechter_eigenwahl"].wert?"erlaubt":"verboten")+")</q>";
											AuswahlReset();
											if (IstRolleInaktiv(crolle))
											{
												Anzeige_Notiz(rollentext+einstellungen["text_vorsicht_tot"].wert);
												rollen[crolle].werte.ziel = -1;
											}
											else
											{
												Anzeige_Auswahl(rollentext,function(spieler){if (spieler.lebt && (einstellungen["leibwaechter_eigenwahl"].wert?true:spieler.rolle!=rids["leibwaechter"]) && (spieler.spielerID!=rollen[crolle].werte.letztes_ziel)) {return true;} else return false;});
											}
											break;
										case 1:
											if (Check_Auswahl(0,1,!IstRolleInaktiv(crolle)))
											{
												rollen[crolle].werte.ziel = (auswahl.length>0?auswahl[0]:-1);
												Anzeige_Notiz("<q>Der Nachtw√§chter / Priester hat seine Wahl getroffen und schl√§ft wieder ein.</q>");
												cschritt++;
											}
											break;
										case 2:
											RolleEnde();
											break;
									}
								}
							},
							});
				NeueRolle({name:"Alte Vettel",strid:"altevettel",
							balance:+1,
							funktion_nacht:function()
							{
								if (!rollen[crolle].notiert)
								{
									switch (cschritt)
									{
										case 0:
											cschritt++;
											Anzeige_Auswahl("<q>Die <b>Alte Vettel</b> verbreitet so schlimme Ger√ºchte, dass der betroffene Dorfbewohner sich am folgenden Tag nicht blicken lassen kann. Da er nicht anwesend ist, kann er weder etwas zur Diskussion beitragen noch kann gegen ihn gestimmt werden.</q> <b>(Alte Vettel erfassen falls vorhanden)</b>",function(spieler){return HatKeineRolle(spieler);});
											rollen[crolle].werte.ziel = -1;
											break;
										case 1:
											if (Check_Auswahl(0,1,false))
											{
												if (auswahl.length>0)
												{
													rollen[crolle].spieler = auswahl;
													RollenUebertragen(crolle);
												}
												cschritt = 0;
												rollen[crolle].notiert = true;
											}
											break;
									}
								}
								if (rollen[crolle].notiert)
								{
									if (!IstRolleAufzurufen(crolle))
									{
										rollen[crolle].werte.ziel = -1;
										cschritt = 3;
									}
									switch (cschritt)
									{
										case 0:
											cschritt++;
											var rollentext = "<q>Die Alte Vettel erwacht. <b>√úber wen</b> m√∂chte sie Ger√ºchte verbreiten? (Eigenwahl verboten)</q>";
											AuswahlReset();
											if (IstRolleInaktiv(crolle))
											{
												cschritt++;
												Anzeige_Notiz(rollentext+einstellungen["text_vorsicht_tot"].wert);
												rollen[crolle].werte.ziel = -1;
											}
											else
											{
												Anzeige_Auswahl(rollentext,function(spieler){if (spieler.lebt && (spieler.rolle!=rids["altevettel"])) {return true;} else return false;});
											}
											break;
										case 1:
											if (Check_Auswahl(0,1,true))
											{
												rollen[crolle].werte.ziel = (auswahl.length>0?auswahl[0]:-1);
												if (auswahl.length>0)
												{
													leute[auswahl[0]].verstummt = true;
													leute[auswahl[0]].waehlbar = false;
												}
												cschritt++;
												Schritt();
											}
											break;
										case 2:
											cschritt++;
											Anzeige_Notiz("<q>Die Alte Vettel hat ihre Wahl getroffen und schl√§ft wieder ein.</q>");
											break;
										case 3:
											RolleEnde();
											break;
									}
								}
							},
							});
				NeueRolle({name:"Hexe",strid:"hexe",
							balance:+4,
							funktion_nacht:function()
							{
								if (!rollen[crolle].notiert)
								{
									switch (cschritt)
									{
										case 0:
											cschritt++;
											rollen[crolle].werte.retten = 1;
											rollen[crolle].werte.toeten = 1;
											rollen[crolle].werte.ziel_retten = -1;
											rollen[crolle].werte.ziel_toeten = -1;
											Anzeige_Auswahl("<q>Die <b>Hexe</b> kann einmalig nachts einen Spieler durch einen Heiltrank vor dem Tod oder der Verwandlung retten. Bis sie sich daf√ºr entscheidet erf√§hrt sie deshalb jede Nacht, wer von den Werw√∂lfen angegriffen wird. Au√üerdem kann sie einmalig nachts einen Spieler mit einem Gifttrank t√∂ten.</q> <b>(Hexe erfassen falls vorhanden)</b>",function(spieler){return HatKeineRolle(spieler);});
											break;
										case 1:
											if (Check_Auswahl(0,1,false))
											{
												if (auswahl.length>0)
												{
													rollen[crolle].spieler = auswahl;
													RollenUebertragen(crolle);
												}
												cschritt = 0;
												rollen[crolle].notiert = true;
											}
											break;
									}
								}
								if (rollen[crolle].notiert)
								{
									if (!IstRolleAufzurufen(crolle))
									{
										rollen[crolle].werte.ziel_retten = -1;
										rollen[crolle].werte.ziel_toeten = -1;
										cschritt = 4;
									}
									var kann_retten = (rollen[crolle].werte.retten>0?true:false);
									var kann_toeten = (rollen[crolle].werte.toeten>0?true:false);
									switch (cschritt)
									{
										case 0:
											cschritt++;
											var kandidaten = new Array();
											for (var i in rollen[rids["werwolf"]].werte.ziele)
											{
												kandidaten.push(leute[rollen[rids["werwolf"]].werte.ziele[i]].name);
											}
											var kandidatentext = (kann_retten?(rollen[rids["werwolf"]].werte.ziele.length>0?kandidaten.join(", "):"keine!"):"kein Heiltrank √ºbrig");
											var rollentext = "<q>Der Hexe erwacht und erf√§hrt, wer diese Nacht von den W√∂lfen angegriffen wurde.</q><b>Signalisiere der Hexe die Todeskandidaten:</b> <i>"+kandidatentext+"</i><q>M√∂chte sie eine Person <b>retten</b>?</q>"+(kann_retten?"<b>"+(((einstellungen["hexe_eigenschutz"].wert==false) && contains(rollen[rids["werwolf"]].werte.ziele,rollen[crolle].spieler))?"(Eigenschutz verboten!) ":"")+"(falls nicht, einfach keinen Spieler ausw√§hlen)</b>":"");
											AuswahlReset();
											if (IstRolleInaktiv(crolle))
											{
												Anzeige_Notiz(rollentext+einstellungen["text_vorsicht_tot"].wert);
												rollen[crolle].werte.ziel_retten = -1;
											}
											else if (!kann_retten)
											{
												Anzeige_Notiz(rollentext+einstellungen["text_vorsicht_aktionslos"].wert);
												rollen[crolle].werte.ziel_retten = -1;
											}
											else
											{
												Anzeige_Auswahl(rollentext,function(spieler){if (contains(rollen[rids["werwolf"]].werte.ziele,spieler.spielerID)) {if ((einstellungen["hexe_eigenschutz"].wert==false) && contains(rollen[rids["hexe"]].spieler,spieler.spielerID)){return false;} else return true;} else return false;});
											}
											break;
										case 1:
											if (Check_Auswahl(0,1,false))
											{
												rollen[crolle].werte.ziel_retten = (auswahl.length>0?auswahl[0]:-1);
												if (auswahl.length>0)
												{
													rollen[crolle].werte.retten--;
												}
												Anzeige_Notiz("<q>Die Hexe hat ihre Wahl getroffen.</q>");
												cschritt++;
											}
											break;
										case 2:
											cschritt++;
											var rollentext = (kann_toeten?"":"<b>Signalisiere der Hexe:</b> <i>kein Gifttrank √ºbrig</i>")+"<q>M√∂chte sie eine Person <b>t√∂ten</b>?</q>"+(kann_toeten?"<b>(falls nicht, einfach keinen Spieler ausw√§hlen)</b>":"");
											if (IstRolleInaktiv(crolle))
											{
												Anzeige_Notiz(rollentext+einstellungen["text_vorsicht_tot"].wert);
												rollen[crolle].werte.ziel_toeten = -1;
												AuswahlReset();
											}
											else if (!kann_toeten)
											{
												Anzeige_Notiz(rollentext+einstellungen["text_vorsicht_aktionslos"].wert);
												rollen[crolle].werte.ziel_toeten = -1;
											}
											else
											{
												Anzeige_Auswahl(rollentext,function(spieler){if (spieler.lebt) {return true;} else return false;});
											}
											break;
										case 3:
											if (Check_Auswahl(0,1,false))
											{
												rollen[crolle].werte.ziel_toeten = (auswahl.length>0?auswahl[0]:-1);
												if (auswahl.length>0)
												{
													rollen[crolle].werte.toeten--;
												}
												Anzeige_Notiz("<q>Die Hexe hat ihre Wahl getroffen und schl√§ft wieder ein.</q>");
												cschritt++;
											}
											break;
										case 4:
											RolleEnde();
											break;
									}
								}
							},
							});
				NeueRolle({name:"Verfluchter",strid:"verfluchter",
							balance:-3,
							funktion_nacht:function()
							{
								if (!rollen[crolle].notiert)
								{
									switch (cschritt)
									{
										case 0:
											cschritt++;
											rollen[crolle].werte.istwolf = false;
											Anzeige_Auswahl("<q>Der <b>Verfluchte</b> erwacht. Er bleibt solange ein normaler Dorfbewohner und versucht mit diesen zu gewinnen, bis er von den W√∂lfen angegriffen wird. Daraufhin wechselt er die Seiten: Er ist als Wolf zu behandeln und - wichtig! - erwacht auch mit diesen. <i>Jede Nacht wird dem Verfluchten gezeigt, ob er sich verwandelt hat!</i></q> <b>(Verfluchten erfassen falls vorhanden)</b>",function(spieler){return HatKeineRolle(spieler);});
											break;
										case 1:
											if (Check_Auswahl(0,1,false))
											{
												if (auswahl.length>0)
												{
													rollen[crolle].spieler = auswahl;
													RollenUebertragen(crolle);
												}
												cschritt = 0;
												rollen[crolle].notiert = true;
											}
											break;
									}
								}
								if (rollen[crolle].notiert)
								{
									if (!IstRolleAufzurufen(crolle))
									{
										cschritt = 1;
									}
									switch (cschritt)
									{
										case 0:
											cschritt++;
											if (contains(rollen[rids["werwolf"]].werte.ziele,rollen[crolle].spieler))
											{
												if (rollen[rids["hexe"]].werte.ziel_retten!=rollen[crolle].spieler)
												{
													if (rollen[rids["leibwaechter"]].werte.ziel!=rollen[crolle].spieler)
													{
														rollen[crolle].werte.istwolf = true;
														rollen[crolle].istboese = true;
													}
												}
											}
											var reaktion = (IstRolleInaktiv(crolle)?einstellungen["text_vorsicht_tot"].wert:"Signalisiere dem Verfluchten: "+((rollen[crolle].werte.istwolf)?"Zum Werwolf verwandelt":"Ist noch Dorfbewohner")+".");
											Anzeige_Notiz("<q>Der <b>Verfluchte</b> erwacht. Er erkennt sein Schicksal...</q><b>("+reaktion+")</b><q>...und schl√§ft wieder ein.</q>");
											break;
										case 1:
											RolleEnde();
											break;
									}
								}
							},
							});
				NeueRolle({name:"Seher",strid:"seher",
							balance:+7,
							funktion_nacht:function()
							{
								if (!rollen[crolle].notiert)
								{
									switch (cschritt)
									{
										case 0:
											cschritt++;
											Anzeige_Auswahl("<q>Der <b>Seher</b> kann seine Kristallkugel (den Spielleiter) jede Nacht zu einem Spieler befragen und erf√§hrt, ob dieser ein Werwolf ist.</q> <b>(Seher erfassen falls vorhanden)</b>",function(spieler){return HatKeineRolle(spieler);});
											rollen[crolle].werte.ziel = -1;
											break;
										case 1:
											if (Check_Auswahl(0,1,false))
											{
												if (auswahl.length>0)
												{
													rollen[crolle].spieler = auswahl;
													RollenUebertragen(crolle);
												}
												cschritt = 0;
												rollen[crolle].notiert = true;
											}
											break;
									}
								}
								if (rollen[crolle].notiert)
								{
									if (!IstRolleAufzurufen(crolle))
									{
										rollen[crolle].werte.ziel = -1;
										cschritt = 2;
									}
									switch (cschritt)
									{
										case 0:
											cschritt++;
											var rollentext = "<q>Der Seher erwacht. <b>√úber wen</b> m√∂chte er seine Kugel befragen?</q>";
											AuswahlReset();
											if (IstRolleInaktiv(crolle))
											{
												Anzeige_Notiz(rollentext+einstellungen["text_vorsicht_tot"].wert);
												rollen[crolle].werte.ziel = -1;
											}
											else
											{
												Anzeige_Auswahl(rollentext,function(spieler){if (spieler.lebt && (spieler.rolle!=rids["seher"])) {return true;} else return false;});
											}
											break;
										case 1:
											if (Check_Auswahl(0,1,!IstRolleInaktiv(crolle)))
											{
												var antwort;
												rollen[crolle].werte.ziel = (auswahl.length>0?auswahl[0]:-1);
												if (rollen[crolle].werte.ziel!=-1)
												{
													antwort = (((leute[rollen[crolle].werte.ziel].rolle==rids["werwolf"]) || ((leute[rollen[crolle].werte.ziel].rolle==rids["verfluchter"]) && (rollen[rids["verfluchter"]].werte.istwolf )))?"Ist Werwolf!":"Kein Werwolf.");
												}
												else
												{
													antwort = "(keine Antwort)";
												}
												Anzeige_Notiz("<q>Der Seher erf√§hrt, ob sein Ziel ein Werwolf ist...</q>"+antwort+"<q>...und schl√§ft wieder ein.</q>");
												cschritt++;
											}
											break;
										case 2:
											RolleEnde();
											break;
									}
								}
							},
							});
				NeueRolle({name:"Prinz",strid:"prinz",
							balance:+3,
							funktion_nacht:function()
							{
								if (!rollen[crolle].notiert)
								{
									switch (cschritt)
									{
										case 0:
											cschritt++;
											rollen[crolle].werte.erkannt = false;
											Anzeige_Auswahl("<q>Dem <b>Prinz</b> geschieht beim ersten Versuch ihn tags√ºber zu h√§ngen nichts, da er im letzten Moment von den Dorfbewohnern erkannt wird.</q> <b>(Prinz erfassen falls vorhanden)</b>",function(spieler){return HatKeineRolle(spieler);});
											break;
										case 1:
											if (Check_Auswahl(0,1,false))
											{
												if (auswahl.length>0)
												{
													rollen[crolle].spieler = auswahl;
													RollenUebertragen(crolle);
												}
												rollen[crolle].notiert = true;
												rollen[crolle].erwacht = false;
												RolleEnde();
											}
											break;
									}
								}
							},
							});
				NeueRolle({name:"Harter Bursche",strid:"harterbursche",
							balance:+3,
							funktion_nacht:function()
							{
								if (!rollen[crolle].notiert)
								{
									switch (cschritt)
									{
										case 0:
											cschritt++;
											rollen[crolle].werte.angegriffen = false;
											Anzeige_Auswahl("<q>Der <b>Harte Bursche</b> stirbt erst eine Nacht nachdem er von den Werw√∂lfen angegriffen wurde. Diese Verz√∂gerung sorgt nat√ºrlich f√ºr etwas Verwirrung.</q> <b>(Harten Burschen erfassen falls vorhanden)</b>",function(spieler){return HatKeineRolle(spieler);});
											break;
										case 1:
											if (Check_Auswahl(0,1,false))
											{
												if (auswahl.length>0)
												{
													rollen[crolle].spieler = auswahl;
													RollenUebertragen(crolle);
												}
												rollen[crolle].notiert = true;
												rollen[crolle].erwacht = false;
												RolleEnde();
											}
											break;
									}
								}
							},
							});
				NeueRolle({name:"Dorfbewohner",strid:"dorfbewohner",
							balance:+1,
							einzelrolle:false,
							funktion_nacht:function()
							{
								if (!rollen[crolle].notiert)
								{
									RollenDorfbewohnerUebertragen(crolle);
									rollen[crolle].notiert = true;
									rollen[crolle].erwacht = false;
								}
								RolleEnde();
							},
							});
				
				SpielerToeten = function(ziel, ursprung)
				{
					var feedback = new Object();
					feedback.erfolg = true;
					feedback.ausgabe = "";
					
					//MEHRFACHT√ñTUNGEN GIBTS NET
					if (leute[ziel].lebt==false)
					{
						feedback.erfolg = false;
						return feedback;
					}
					
					//TOD VERHINDERN
					if ((rollen[rids["prinz"]].anzahl>0) && (leute[ziel].rolle==rids["prinz"]) && contains(["galgen"],ursprung) && (rollen[rids["prinz"]].werte.erkannt==false))
					{
						rollen[rids["prinz"]].werte.erkannt = true;
						feedback.erfolg = false;
						feedback.ausgabe += "<q>Im letzten Moment erkennt das Dorf den Prinzen und rettet ihn vor dem Galgentod.</q>";
						return feedback;
					}
					if ((rollen[rids["leibwaechter"]].anzahl>0) && (ziel==rollen[rids["leibwaechter"]].werte.ziel) && (ursprung!="galgen"))
					{
						feedback.erfolg = false;
						return feedback;
					}
					if ((rollen[rids["hexe"]].anzahl>0) && (ziel==rollen[rids["hexe"]].werte.ziel_retten) && contains(["werwolf"],ursprung))
					{
						feedback.erfolg = false;
						return feedback;
					}
					if ((rollen[rids["verfluchter"]].anzahl>0) && (leute[ziel].rolle==rids["verfluchter"]) && contains(["werwolf"],ursprung))
					{
						feedback.erfolg = false;
						return feedback;
					}
					if ((rollen[rids["harterbursche"]].anzahl>0) && (leute[ziel].rolle==rids["harterbursche"]) && contains(["werwolf"],ursprung) && (rollen[rids["harterbursche"]].werte.angegriffen==false))
					{
						rollen[rids["harterbursche"]].werte.angegriffen = true;
						feedback.erfolg = false;
						return feedback;
					}

					//TOD VERARBEITEN
					leute[ziel].lebt = false;
					rollen[leute[ziel].rolle].lebende--;

					if ((ursprung=="galgen") && (einstellungen["rolle_lynchen_bekanntgeben"].wert))
					{
						rollen[leute[ziel].rolle].bekannt++;
						feedback.ausgabe += "<q>"+(einstellungen["rolle_lynchen_bekanntgeben"].wert
														?"Rolle: "+rollen[leute[ziel].rolle].name
														:"Er hatte eine "+(rollen[leute[ziel].rolle].istboese?"b√∂se":"gute")+" Rolle."
													)+"</q>";
					}
					if (ursprung=="liebe")
					{
						if (einstellungen["rolle_verliebt_bekanntgeben"].wert)
						{
							rollen[leute[ziel].rolle].bekannt++;
						}
						feedback.ausgabe += "<q>Aufgrund von Liebeskummer hat sich "+leute[ziel].name+" von einer Klippe gest√ºrzt. "+
											(einstellungen["rolle_lynchen_bekanntgeben"].wert
												?"Rolle: "+rollen[leute[ziel].rolle].name
												:"Er hatte eine "+(rollen[leute[ziel].rolle].istboese?"b√∂se":"gute")+" Rolle."
											)+"</q>";
					}

					//TODESREAKTIONEN
					//Amor & Verliebte
					if ((rollen[rids["amor"]].anzahl>0) && (rollen[rids["amor"]].werte.verliebte.length==2))
					{
						var verliebter = -1;
						if (ziel==rollen[rids["amor"]].werte.verliebte[0])
						{
							verliebter = rollen[rids["amor"]].werte.verliebte[1];
						}
						else if (ziel==rollen[rids["amor"]].werte.verliebte[1])
						{
							verliebter = rollen[rids["amor"]].werte.verliebte[0];
						}
						if (verliebter>=0 && leute[verliebter].lebt)
						{
							var vtext = SpielerToeten(verliebter, "liebe");
							feedback.ausgabe += vtext.ausgabe;
						}
					}
					
					return feedback;
				}
				
				Tagesaktionen = function()
				{
					var report = new Array;
					switch (cschritt)
					{
						case 0:
							//TAG BRICHT AN: Tote in Arrays sammeln, Nachrichten verk√ºndigen
							cschritt++;
							report.push("Ein neuer Tag bricht an und das Dorf erwacht.");
							var gestorben_namen = new Array();
							var gestorben_ids = new Array();
							var zusatztext = "";
							
							//Harter-Bursche-Verz√∂gerungstod
							if ((rollen[rids["harterbursche"]].anzahl>0) && (rollen[rids["harterbursche"]].werte.angegriffen))
							{
								var ziel = rollen[rids["harterbursche"]].spieler[0];
								var feedback = SpielerToeten(ziel, "harterbursche");
								if (feedback.erfolg)
								{
									zusatztext += feedback.ausgabe;
									gestorben_namen.push(leute[ziel].name);
									gestorben_ids.push(leute[ziel].spielerID);
								}
							}
							//Werwolftode
							for (var i in rollen[rids["werwolf"]].werte.ziele)
							{
								var ziel = rollen[rids["werwolf"]].werte.ziele[i];
								var feedback = SpielerToeten(ziel, "werwolf");
								if (feedback.erfolg)
								{
									zusatztext += feedback.ausgabe;
									gestorben_namen.push(leute[ziel].name);
									gestorben_ids.push(leute[ziel].spielerID);
								}
							}
							//Gifttod (Hexe)
							if ((rollen[rids["hexe"]].anzahl>0) && (rollen[rids["hexe"]].werte.ziel_toeten>=0))
							{
								var ziel = rollen[rids["hexe"]].werte.ziel_toeten;
								var feedback = SpielerToeten(ziel, "hexe");
								if (feedback.erfolg)
								{
									zusatztext += feedback.ausgabe;
									gestorben_namen.push(leute[ziel].name);
									gestorben_ids.push(leute[ziel].spielerID);
								}
							}
							//Alte Vettel
							if ((rollen[rids["altevettel"]].anzahl>0) && (rollen[rids["altevettel"]].werte.ziel>=0))
							{
								if (leute[rollen[rids["altevettel"]].werte.ziel].lebt)
								{
									report.push(leute[rollen[rids["altevettel"]].werte.ziel].name + " ist heute vor Scham √ºber die Ger√ºchte im Umlauf abwesend (schweigt und ist nicht lynchbar/w√§hlbar).");
								}
								else
								{
									report.push("√úber "+leute[rollen[rids["altevettel"]].werte.ziel].name + " wurden zwar schlimmste Ger√ºchte verbreitet, aber √ºber die Toten l√§stert man nicht.");
								}
							}
							//Report und Lynchjustiz
							switch (gestorben_ids.length)
							{
								case 0:
									report.push("In dieser Nacht ist niemand gestorben.");
									break;
								case 1:
									report.push(gestorben_namen[0]+" ist in der Nacht gestorben.");
									break;
								default:
									report.push("Gestorben sind in dieser Nacht: "+gestorben_namen.join(", ")+".");
									break;
							}
							
							//ANZEIGE
							Anzeige_Notiz('<q>'+report.join(" ")+'</q>');
							Anzeige_Zusatz(zusatztext+'<b>(Diskussionsphase)</b>');
							break;
						case 1:
							cschritt++;
							report.push('<q>Ein Lynchmob tut sich zusammen, fest entschlossen das B√∂se zu entlarven.<b>Wer soll nun h√§ngen?</b></q>');
							Anzeige_Auswahl(report.join(" ")+' <b>(Abstimmungsphase)</b>',function(spieler){if (spieler.lebt && spieler.waehlbar) {return true;} else return false;});
							break;
						case 2:
							if (Check_Auswahl(0,1,true))
							{
								cschritt++;
								cschritt+=2; //deaktiviert Noch-jmd-lynchen-Frage
								if (auswahl.length==0)
								{
									Anzeige_Notiz("<q>Niemand wurde gelyncht.</q>");
								}
								else
								{
									//TAGESLYNCHEN
									var ziel = auswahl[0];
									var feedback = SpielerToeten(ziel, "galgen");
									if (feedback.erfolg)
									{
										Anzeige_Notiz('<q>'+leute[ziel].name+" wurde gelyncht.</q>");
										Anzeige_Zusatz(feedback.ausgabe);
									}
									else
									{
										Anzeige_Notiz(feedback.ausgabe);
									}
								}
							}
							break;
						case 3:
							//DEAKTIVIERT! (siehe oben)
							cschritt++;
							Anzeige_Entscheidung("Noch jemanden h√§ngen? <i>(Standard ist nur einmal Lynchen pro Tag)</i>");
							break;
						case 4:
							if (entscheidung)
							{
								cschritt = 1;
							}
							else
							{
								cschritt++;
							}
							Schritt();
							break;
						case 5:
							cschritt++;
							//TAG BEENDET: Aufr√§umen, z.B. Effekte wiederaufheben
							Anzeige_Notiz("<q>Die Nacht bricht √ºber dem Dorf herein...</q>");
							//Alte Vettel
							if (rollen[rids["altevettel"]].anzahl>0)
							{
								var ziel = rollen[rids["altevettel"]].werte.ziel;
								if (rollen[crolle].werte.ziel!=-1)
								{
									leute[ziel].verstummt = false;
									leute[ziel].waehlbar = true;
								}
							}
							//Hexe (theoretisch nicht n√∂tig, schon im Zugcode vorhanden)
							if (rollen[rids["hexe"]].anzahl>0)
							{
								rollen[rids["hexe"]].werte.ziel_retten = -1;
								rollen[rids["hexe"]].werte.ziel_toeten = -1;
							}
							//Leibw√§chter
							if (rollen[rids["leibwaechter"]].anzahl>0)
							{
								rollen[rids["leibwaechter"]].werte.letztes_ziel = rollen[rids["leibwaechter"]].werte.ziel;
								rollen[rids["leibwaechter"]].werte.ziel = -1;
							}
							break;
						case 6:
							Phasenwechsel();
							break;
						case 777:
							Anzeige_Notiz_Solo('Danke f√ºr\'s Spielen und das Benutzen dieser WebApp =)<div class="zentriermich"><br><button class="listenbutton menulistenbutton" onclick="Button_Neustart();">Neustart</button></div>');
							Anzeige_Menu(["spiel_guide","spiel_status"]);
							break;
					}
					if (cschritt!=777 && Check_Sieg())
					{
						localStorage.removeItem("NWWA_Speicherstand");
						running = false;
						cschritt = 777;
					}
				}

				Aktion_SpielerSchreiben();
				Aktion_RollenSchreiben();
							
			}
			function SpielStart()
			{
				if (spieleranzahl<6)
				{
					Anzeige_Hinweis("Man kann Werwolf leider nicht sinnvoll mit weniger als 6 Spielern spielen =(");
					return false;
				}
				if (rollenanzahl<spieleranzahl)
				{
					Anzeige_Hinweis("Weniger Rollen als Spieler sind nicht m√∂glich!");
					return false;
				}
				if (rollen[rids['werwolf']].anzahl==0)
				{
					Anzeige_Hinweis("Ohne Werwolf geht es nun wirklich nicht...");
					return false;
				}
				
				running = true;
				Anzeige_Menu(["spiel_guide"]);
				
				cphase = "tag"; //erster Phasenwechsel bewirkt Start mit Nacht!
				crolle = -1; //Damit die Statusanzeige nicht spinnt
				tagzahl = 0;
				nachtzahl = 0;
				//M√∂gliche Rollen als "Im Spiel" markieren
				for (var index in rollen)
				{
					if (rollen[index].anzahl > 0) rollen[index].imspiel = true;
				}
				//Spieler aktivieren
				for (var index in leutesammler)
				{
					NeuerSpieler({name:leutesammler[index]});
				}
				//Virtuelle Karten generieren
				Aktion_KartenZufallsliste();
				Aktion_KartenVerteilen(0);
				//Introtextanzeige
				Anzeige_Notiz_Solo("Willkommen zu einer neuen Partie Werwolf!<hr>"+
				"<h3>Kleine Erkl√§rhilfe</h3><ol><li>Grundprinzip der Werwolfsbedrohung</li><li>Ziele der Parteien und Siegbedingungen</li><li>Normaler Tag-Nacht-Zyklus</li><li>Regeln f√ºr die Nacht</li><li>Ablauf des Tages mit Lynchregeln</li><li>Sondercharaktere im Spiel</li><li>Regeln f√ºr Tote, Umgang mit Rollenkarten, Umgang mit Wahrheit und L√ºge</li></ol>"+
				"<hr><p style=\"font-size:1.0em;\">Kein Werwolfspiel mit Rollenkarten zur Hand? Hier gibt's virtuelle Karten:</p>"+
				"<div class=\"zentriermich\"><button class=\"blaubutton\" onclick=\"Anzeige_Menu(['spiel_rollenvergabe']);\">Kartenvergabe</button></div>"+
				"<hr><q>Das Dorf schl√§ft ein, alle schlie√üen die Augen.</q>"+
				"");
				
				document.getElementById("ausgabeinteraktion").innerHTML = '<div class="zentriermich"><button class="blaubutton" onclick="this.style.visibility=\'hidden\';Anzeige_Menu([\'spiel_guide\',\'spiel_status\',\'spiel_admin\']);Phasenwechsel();">Alle schlafen&nbsp;&#9658;</button></div>';
			}
			function Phasenwechsel()
			{
				//Am Anfang jeder Nacht aktuelles Spiel sichern, ggf. auch in HTML5-Browser-Storage
				if (cphase=="tag")
				{
					speicherstand = ErstelleSpeicherstand();
					if (supports_html5_storage())
					{
						localStorage.NWWA_Speicherstand = speicherstand;
					}
				}
			
				//Tag/Nacht-Wechsel
				if (cphase=="tag") {cphase = "nacht";} else {cphase = "tag";}
				
				switch (cphase)
				{
					case "nacht":
						nachtzahl++;
						crolle = 0;
						RolleStart();
						break;
					case "tag":
						tagzahl++;
						crolle = -1;
						RolleStart();
						break;
				}
				SchrittuhrNeustart();
			}
			function RolleStart()
			{
				cschritt = 0;
				Schritt();
			}
			function RolleEnde()
			{
				crolle++;
				if (crolle >= rollen.length)
				{
					Phasenwechsel();
				}
				else RolleStart();
			}
			function Schritt()
			{
				window.scrollTo(0,1);
				switch (cphase)
				{
					case "nacht":
						switch (rollen[crolle].strid)
						{
							default:
								if (rollen[crolle].funktion_nacht===false)
								{
									RolleEnde();
								}
								else if(rollen[crolle].imspiel && rollen[crolle].erwacht)
								{
									rollen[crolle].funktion_nacht();
								}
								else
								{
									RolleEnde();
								}
								break;
						}
						break;
					case "tag":
						Tagesaktionen();
						break;
				}
				Statusupdate();
			}
			function BerechneBalance()
			{
				var balance = 0;
				for (var index in rollen)
				{
					balance += (rollen[index].balance * rollen[index].anzahl);
				}
				return (balance>0?"+":"")+balance;
			}
			function RollenUebertragen(rollenid)
			{
				var rollenspieler = rollen[rollenid].spieler;
				for (var index in rollenspieler)
				{
					leute[rollenspieler[index]].rolle = rollenid;
				}
				rollen[rollenid].anzahl = rollen[rollenid].spieler.length;
				rollen[rollenid].lebende += rollen[rollenid].anzahl;
			}
			function RollenDorfbewohnerUebertragen(rollenid)
			{
				for (var index in leute)
				{
					if (leute[index].rolle==-1)
					{
						leute[index].rolle = rollenid;
						rollen[rollenid].spieler.push(leute[index].spielerID);
					}
				}
				rollen[rollenid].anzahl = rollen[rollenid].spieler.length;
				rollen[rollenid].lebende += rollen[rollenid].anzahl;
			}
			function Check_Auswahl(min, max, nullwarnung)
			{
				if (auswahl.length==0 && nullwarnung)
				{
					if (!confirm("Eigentlich sollte hier eine Auswahl stattfinden. Spielleitervollmacht beanspruchen, Warnung ignorieren und niemanden ausw√§hlen?"))
					{
						return false;
					}
				}
				if (max==-1)
				{
					if (auswahl.length<min)
					{
						Anzeige_Hinweis("Auswahl: mind. "+min+" Spieler");
						return false;
					}
				}
				else
				{
					if ((min==max) && (auswahl.length!=min))
					{
						Anzeige_Hinweis("Auswahl: genau "+min+" Spieler!");
						return false;
					}
					else if (auswahl.length<min)
					{
						Anzeige_Hinweis("Auswahl: mind. "+min+" Spieler");
						return false;
					}
					else if (auswahl.length>max)
					{
						Anzeige_Hinweis("Auswahl: max. "+max+" Spieler");
						return false;
					}
				}
				return true;
			}
			function Check_Sieg()
			{
				var gute = 0;
				var boese = 0;
				for (var i in leute)
				{
					if (leute[i].lebt)
					{
						if (leute[i].rolle==rids["werwolf"] || (leute[i].rolle==rids["verfluchter"] && rollen[rids["verfluchter"]].werte.istwolf))
						{
							boese++;
						}
						else
						{
							gute++;
						}
					}
				}
				if (gute == 0)
				{
					Anzeige_Zusatz('<div class="zentriermich"><b>SPIELENDE</b><br>Werw√∂lfe gewinnen</div>');
					return true;
				}
				if (boese == 0)
				{
					Anzeige_Zusatz('<div class="zentriermich"><b>SPIELENDE</b><br>Dorfbewohner gewinnen</div>');
					return true;
				}
				return false;
			}
			function SchrittuhrNeustart()
			{
				document.getElementById("schrittuhr").innerHTML = "00:00";
				if (schrittuhr_intervall)
				{
					clearInterval(schrittuhr_intervall);
				}
				schrittuhr_sek = 0;
				schrittuhr_intervall = setInterval(function(){SchrittuhrUpdate();},1000);
			}
			function SchrittuhrUpdate()
			{
				schrittuhr_sek++;
				var sek = schrittuhr_sek % 60;
				var min = (schrittuhr_sek - sek) / 60;
				sek = (sek<10?'0'+sek:sek);
				min = (min<10?'0'+min:min);
				document.getElementById("schrittuhr").innerHTML = min + ":" + sek;
			}
			function Statusupdate()
			{
				var phasenstatus = "";
				phasenstatus += "<div>"+(cphase=="tag"?"<b>Tag</b>":"Tag")+": "+tagzahl+" - "+(cphase=="nacht"?"<b>Nacht</b>":"Nacht")+": "+nachtzahl+" - <span id=\"schrittuhr\">00:00</span></div>";
				phasenstatus += "<div>Aktuelle Rolle: <i>"+(crolle>=0?rollen[crolle].name:"-")+"</i></div>";
				var ergebnis_lebt = new Array();
				var ergebnis_tot = new Array();
				//Schleife √ºber alle Spieler
				for (var i in leute)
				{
					var klassen = new Array();
					var eintrag = leute[i].name;
					//Randf√§rbung je nach Gesinnung
					if (leute[i].rolle>=0)
					{
						if (rollen[leute[i].rolle].istboese)
						{
							klassen.push("status_boese");
						}
						else
						{
							klassen.push("status_gut");
						}
					}
					//Verliebt-Herzchen
					if ((rollen[rids["amor"]].anzahl>0) && (rollen[rids["amor"]].werte.verliebte) && (rollen[rids["amor"]].werte.verliebte.length==2) && (contains(rollen[rids["amor"]].werte.verliebte,leute[i].spielerID)))
					{
						eintrag += " &hearts;";
					}
					//B√ºrgermeister
					if (false)
					{
						eintrag += " &#9734;";
					}
					//Klassenangabe falls kein Dorfbewohner
					if ((leute[i].rolle>=0) && rollen[leute[i].rolle].strid!="dorfbewohner")
					{
						eintrag += '<span class="status_klassentext">'+rollen[leute[i].rolle].name+'</span>';
					}
					//Fertig, hinzuf√ºgen zu Lebend/Tot zur sp√§teren Ausgabe
					if (!leute[i].lebt)
					{
						klassen.push("status_tot");
						ergebnis_tot.push('<li class="'+klassen.join(" ")+'">'+eintrag+'</li>');
					}
					else
					{
						ergebnis_lebt.push('<li class="'+klassen.join(" ")+'">'+eintrag+'</li>');
					}
				}
				document.getElementById("statusausgabe").innerHTML = phasenstatus + '<ul>' + ergebnis_lebt.join("") + ergebnis_tot.join("") + '</ul>';
			}
			function IstRolleAufzurufen(rollenid)
			{
				if (rollen[rollenid].lebende>0)
				{
					return true;
				}
				else if ((rollen[rollenid].bekannt==rollen[rollenid].anzahl) && einstellungen["rollen_anzahlen_bekannt"].wert)
				{
					return false;
				}
				else if (einstellungen["rolle_tot_zugeben"].wert)
				{
					return false;
				}
				return true;
			}
			function IstRolleInaktiv(rollenid)
			{
				if (rollen[rollenid].lebende==0)
				{
					return true;
				}
				else
				{
					return false;
				}
			}
			function HatKeineRolle(spieler)
			{
				if (leute[spieler.spielerID].rolle==-1)
				{
					return true;
				}
				else
				{
					return false;
				}
			}
				
			
			/* UI-Funktionen */
			
			function TESTSETUP()
			{
				leutesammler = new Array();
				leutesammler.push("Amy");
				leutesammler.push("Bruce");
				leutesammler.push("Christopher");
				leutesammler.push("David");
				leutesammler.push("Eugene");
				leutesammler.push("Freema");
				leutesammler.push("Gilroy");
				leutesammler.push("Harley");
				leutesammler.push("Irene");
				leutesammler.push("John");
				leutesammler.push("Karen");
				leutesammler.push("Lisa");
				leutesammler.push("Matt");
				leutesammler.push("Norman");
				leutesammler.push("Olaf");
				Aktion_SpielerSchreiben();
				Aktion_RolleEintragen(rids['werwolf']);
				Aktion_RolleEintragen(rids['harterbursche']);
				Aktion_RolleEintragen(rids['hexe']);
				Aktion_RolleEintragen(rids['dorfbewohner']);
				Aktion_RolleEintragen(rids['dorfbewohner']);
				Aktion_RolleEintragen(rids['dorfbewohner']);
				Aktion_RolleEintragen(rids['dorfbewohner']);
				Aktion_RolleEintragen(rids['dorfbewohner']);
				Aktion_RolleEintragen(rids['dorfbewohner']);
				Aktion_RolleEintragen(rids['dorfbewohner']);
				Aktion_RolleEintragen(rids['dorfbewohner']);
				Aktion_RolleEintragen(rids['dorfbewohner']);
				Aktion_RolleEintragen(rids['dorfbewohner']);
				Aktion_RolleEintragen(rids['dorfbewohner']);
				Aktion_RolleEintragen(rids['dorfbewohner']);
			}
			function Anzeige_Menu(anzeige)
			{
				var felder = ["spiel_hauptmenu","spiel_setup","spiel_guide","spiel_status","spiel_anleitung","spiel_einstellungen","spiel_admin","spiel_rollenvergabe"];
				for (var i in felder)
				{
					document.getElementById(felder[i]).style.display = "none";
				}
				for (var i in anzeige)
				{
					document.getElementById(anzeige[i]).style.display = "block";
					if (anzeige[i]=="spiel_hauptmenu")
					{
						if (spielstand_vorhanden())
						{
							document.getElementById("continuebutton").style.display = "inline";
						}
						else
						{
							document.getElementById("continuebutton").style.display = "none";
						}
					}
					if (anzeige[i]=="spiel_setup")
					{
						Aktion_SpielerSchreiben();
						Aktion_RollenSchreiben();
					}
					if (anzeige[i]=="spiel_einstellungen")
					{
						Aktion_EinstellungenSchreiben();
					}
				}
				window.scrollTo(0,1);
			}
			function Anzeige_Zusatz(notiz)
			{
				document.getElementById("ausgabecontent").innerHTML += notiz;
			}
			function Anzeige_Entscheidung(frage)
			{
				document.getElementById("ausgabecontent").innerHTML = frage;
				document.getElementById("ausgabeinteraktion").innerHTML = '<button class="blaubutton jabutton" onclick="this.style.visibility=\'hidden\';entscheidung=true;Schritt();">Ja&nbsp;&#10004;</button><button class="blaubutton neinbutton" onclick="this.style.visibility=\'hidden\';entscheidung=false;Schritt();">Nein&nbsp;&#10006;</button>';
			}
			function Anzeige_Notiz(notiz)
			{
				document.getElementById("ausgabecontent").innerHTML = notiz;
				document.getElementById("ausgabeinteraktion").innerHTML = '<div class="zentriermich"><button class="blaubutton" onclick="this.style.visibility=\'hidden\';Schritt();">Weiter&nbsp;&#9658;</button></div>';
			}
			function Anzeige_Notiz_Solo(notiz)
			{
				document.getElementById("ausgabecontent").innerHTML = notiz;
				document.getElementById("ausgabeinteraktion").innerHTML = '';
			}
			function AuswahlReset()
			{
				auswahl = new Array();
			}
			function Anzeige_Auswahl(nachricht, filterfunktion) //Spielerauswahl
			{
				var liste = "";
				AuswahlReset();
				for (var index in leute)
				{
					if (filterfunktion(leute[index]))
					{
						liste += '<option value="'+leute[index].spielerID+'">'+leute[index].name+'</option>';
					}
				}
				liste = '<div><select id="spielerauswahl" size="1" onChange="Aktion_AuswahlPlus(this.options[this.selectedIndex].value);"><option selected="selected" value="-1">&#9660;&nbsp;Spieler...</option>'+liste+'</select>';
				liste += '<button class="blaubutton" id="auswahlbutton" onclick="Schritt();">OK&nbsp;&#9658;</button></div>';
				liste += '<ul id="auswahlanzeige"></ul>';
				document.getElementById("ausgabecontent").innerHTML = nachricht;
				document.getElementById("ausgabeinteraktion").innerHTML = liste;
			}
			function Aktion_AuswahlPlus(plus)
			{
				plus = parseInt(plus);
				if (plus==-1) {return;}
				if (!contains(auswahl,plus))
				{
					auswahl.push(plus);
				}
				Aktion_AuswahlSchreiben();
			}
			function Aktion_AuswahlMinus(minus)
			{
				for (var index in auswahl)
				{
					if (auswahl[index]==minus)
					{
						auswahl.splice(index,1);
						break;
					}
				}
				Aktion_AuswahlSchreiben();
			}
			function Aktion_AuswahlSchreiben()
			{
				var ergebnis = new Array();
				for (var index in auswahl)
				{
					ergebnis.push('<li>'+leute[auswahl[index]].name+'&nbsp;<button class="listenbutton" onclick="Aktion_AuswahlMinus('+auswahl[index]+');">'+
									'<img src="data:image/png;base64,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">'+
									'</button></li>');
				}
				document.getElementById("auswahlanzeige").innerHTML = ergebnis.join("");
				document.getElementById("spielerauswahl").selectedIndex = 0;
			}
			function Aktion_SpielerEintragen()
			{
				if (document.getElementById("spielername").value.trim()!="")
				{
					var neuername = document.getElementById("spielername").value;
					leutesammler.push(neuername.charAt(0).toUpperCase() + neuername.slice(1));
				}
				Aktion_SpielerSchreiben();
				document.getElementById("spielername").value = "";
				document.getElementById("spielername").focus();
			}
			function Aktion_SpielerAustragen(index)
			{
				leutesammler.splice(index,1);
				Aktion_SpielerSchreiben();
			}
			function Aktion_SpielerSchreiben()
			{
				var liste = new Array();
				for (var index in leutesammler)
				{
					liste.push('<li>'+leutesammler[index]+'<button class="listenbutton" onclick="Aktion_SpielerAustragen('+index+');return false;">'+
								'<img src="data:image/png;base64,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">'+
								'</button></li>');
				}
				var addfield =	'<li><input type="text" id="spielername" placeholder="Neuer Spieler"><button class="listenbutton" onclick="Aktion_SpielerEintragen();return false;">'+
								'<img src="data:image/png;base64,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">'+
								'</button><br>';
				spieleranzahl = liste.length;
				document.getElementById("spielerliste").innerHTML = liste.join("")+addfield;
				document.getElementById("spieleranzahl").innerHTML = liste.length;
			}
			function Aktion_RolleEintragen(index)
			{
				if (index=="-1")
				{
					return;
				}
				if (rollen[index].einzelrolle && rollen[index].anzahl>0)
				{
					Anzeige_Hinweis("Diese Rolle darf es im Spiel nur einmal geben.");
				}
				else
				{
					rollen[index].anzahl++;
				}
				Aktion_RollenSchreiben();
			}
			function Aktion_RolleAustragen(index)
			{
				if (rollen[index].anzahl<=0) return;
				rollen[index].anzahl--;
				Aktion_RollenSchreiben();
			}
			function Aktion_RollenSchreiben()
			{
				var quelle = new Array();
				var liste = new Array();
				var gesamtzahl = 0;
				for (var index in rollen)
				{
					quelle.push('<option value="'+index+'">'+rollen[index].name+'</option>');
					if (rollen[index].anzahl>0)
					{
						liste.push('<li>'+rollen[index].anzahl+' '+rollen[index].name+
									'<button class="listenbutton" onclick="Aktion_RolleAustragen('+index+')">'+
									'<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAEMUlEQVRYhe2UXWgUVxiGn3NmZnd215ndNZtN1DYoKS1KmxQlLRpB26KtigQlGCWgiK14VW8VyUULvSsWRNErfwpGVBShYgWRVDRWkBb1phibbBSbVdQk+787O7unF8mWELL+FGqhzQPnYubM+Z73nPlmYJpp/u+IqW4ehLkCZkkICEgH4fYGyL1K4R4wvdBkgK1DVkK8GWLPDXAQ5ko4BbQIQBsfEoY1+KITzr6M/CqsNeCwBpEJNdDgVw90vAW/TxngEJydt3z5ug+3bkUIgV4qkRsa4u65czy8ebOswdp2uPA8+XX4RIOLEdPU66XEUyhQ9vlw/H5G0mmK2eyPjbC68rycdBwiunAhM5qb8ds2hq4TrKnhg40bmdvUJHU4eR7erSa/AQt0OBsxTX3epk34ikU0jwcjGCRQW4tpmmiTNi0nXZy5s28fjusi6uoQhgGOg3Ac3l+9mlA0OkPCqQtgT5bfhoAGJwK6bs/bvx+6u0EIsG2wLBzXJT8yggZnqgb4HI4L1+3p6eigHAggolGE3w/5PFqpRMuaNQT8/vke+F5NWKtAOHDUK2XTO3v3QlcXuO6Y3LYpaRrDsRiaUj+/AYerBhCgTGjP9PcP3N61CyIR1KxZqPEQXil5r7UVr5RtvfBNZd0v8JUhRPvbO3cie3sRjx6BZY0F8PkYuX8fHOehDusElCc6tclHeRpym+BK+t69zYFw2LAXLQIhEPE4JBKYUuIRguSTJ6074O6Osfe+783GRmEtXQoHDkAgAKEQBIMk43Gc0dGcASujE7q/agCAk/C4E+LPrl5tiy5ejLehASUEYmAAkU4zwzAo5XIin8l8asDaGr/frNu9G7VnD3g8Y/JQiOzoKNl4HAk7o/DDVK4pAwCcgFtbwHp26dKSOW1taMEgStMQfX2Qy2F5POSSSa9XCG/DqlVw6NBY043Li6USqcFBpFIH6uDrap4p/4QVToFWD+ethobPmo4ehWQSdeUKoqcHkc3iplKQy6Hn81AsQjgM4TBlr5fRvj5wnJ9qYKWAYjWHrDYBsAFKOnQ6Dx70D3Z1oUIhaGmBxkbI59GLRXTHQRQKf3W88vlIxWIIx4l5oP158hcGAFgCwzqsT/T2ZkaPHUPU1qJWrICZMyGfh0IBVel4yyI3NITKZLIS1tvw7EX1XxgAYBHcMWDz4yNHVOHGDcScOZQ7OlCmCV7v2CdnWRSGh3GePkWD7WG49TK1qzbhZA7Cb1+CP3vtWqu1bBmyvh5VU4MYGADbxi0WyQ8OosF3Qfj2Zeu+EgpkDC4MRSKqfPq0KnV3K3f7duUuWKAShqFScFG9wqb+Fvch/AfcS7S0qNLly8o9flxlZs9WKehPwMx/VF5hCOY/hURh2zZV6OxUGUinofm1yCsMQ2cSyhkop2HLa5VXSMFHKfj4X5FPM81/hj8BdOd1/TvC+zkAAAAASUVORK5CYII=">'+
									'</button>'+
									'<button class="listenbutton" onclick="Aktion_RolleEintragen('+index+')">'+
									'<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAESklEQVRYhe2TWWxUVRzGf+fcOzN3pstMd6YpCNVQSIGypRBZJaW4lBAwIREJSyA8aQ0KxGhEEjcSjUuQBwKSCPpgDBVCQoBGiQUpKQVZtBZKFygWMLaUkmk7M/ec44OlggEsIjyYfsl9uvf/fb//cqFf/erXfShQMSscqJgVvh8P+W8L/YemT9QyXmds95y/cuakhwrg3zd1oImxszhnfMKIAYMDGL3LOViU+3AAdo8LaMOuUSm5WXMHTSL9kQAev0wTUpdRPTvwwAG8xtkUdkJj3h6xlFpxjt9kOxnDgggpCpzuyOYHCuAre7zURi78tHAlzfYFurhONkH8joeMvGSENgv8h2asuhdPq68fOl9NeALDFx9MekHKkKKR83ixEUgUmog/hpSSrrZYkbU896ja2niuL759moCzrXCIds3XS/KfsnMyU6iniTgKA2SRRDYhwgRJGugnMcMrhau/9B2Y/th/A7BpXEArXTZ+QF7anGGTqaWBLroA0/NANkGyCZJGAql5yXgDdoqEMvYVJ9w3gBe9OcMJjl47eRlnZD3ttPdGx5VLTLlYyL+mIB3S84MIIUb6vLHtGMTd/O96A56NBSttYa3aMu8NmgO/cpGWm94a9ladoK7lEsU5hXQSwYONwtDpiWIlWnRe7hpuNw2Oup+fP3TPAPaHo6YIw/b1s1+yRKamniYMBnoaOnLqLMdr61Vrx3XTTod8NnMmbbQiESgMkUAMSwi6WqPT7MVDKt1tTQ23y7ntCpz3RuYKpXcumljiyRmUTgONKFzAYDDUNbVw+HgNwtWrUWbl4dO1VF45TQH5ZJLUexNJgxNIzHJstN7hLZ86vG8A749KcJUqG/vI8NQ546dRw1kidPfs3dDado39B6pB6a3RJdUfRRdWbUDpLRu+34ET9ZNOKmFChAn9eZT5QbyJnmSpxTeUFwX/EcCKRD9OS0wueH32CmqsOq5yradvQ3c0zu49lcS6YydjXrf0Rk3UZ5fGYu6xJXvfYowaiYXomUKIZOmQMTqEtMhzdGzjXQHsVx99Urhm+frnXqbBaaKFK72dGwzl+6u52nq9xVbiaRadivQWzq/s8riUdHRELq6oeIdnKMKPpxciwe8jbUQQlH7et29yyR0BhJaLSwqnE8+M0khzb7ABqn6ooaH2ootiUeeLP978OwAQWXr0slZqQUPzpfiaE58wlFyC+AkTJEyQQJaDP80HLsvuCGAwKb9H2zjddRaFAgxKKU4cOUNVxc/gqtXuK6e+/Xv4DblLjx80rik9cvIXtv20h7jSPUcZIjOeBNqAMqm3NH3LClYPnYLQu4GgL+AFS+BqjdLaxRLvumtr37xT+M3yfjb2NaRcZ3stj+2xEZak242DJTqEFHO75x3+7rYAAKzJS7KMLpZCpyFBCyuqfO4B1jVc6Ev4Dfk3T8hxPWoGCAcPCCnbYpZbzvxj1+7Fp1/9+v/rDwgiscxlnwJMAAAAAElFTkSuQmCC">'+
									'</button>'+
									'</li>');
					}
					gesamtzahl += rollen[index].anzahl;
				}
				rollenanzahl = gesamtzahl;
				quelle.unshift('<select size="1" onChange="Aktion_RolleEintragen(this.options[this.selectedIndex].value);" id="rollenselect"><option selected="selected" value="-1">&#9660;&nbsp;Rolle hinzuf√ºgen...</option>');
				quelle.push('</select>');
				document.getElementById("rollenliste").innerHTML = liste.join("") +'<li>'+quelle.join(", ")+'</li>';
				document.getElementById("rollenanzahl").innerHTML = gesamtzahl;
				document.getElementById("balanceanzeige").innerHTML = BerechneBalance();
			}
			function Aktion_EinstellungBearbeiten(setid,setvalue)
			{
				einstellungen[setid].wert = (setvalue==1?true:false);
			}
			function Aktion_EinstellungenSchreiben()
			{
				var liste = new Array();
				for (var index in einstellungen)
				{
					if (index.indexOf("text_")==0)
					{
						continue;
					}
					einstellung = einstellungen[index];
					liste.push('<p>'+einstellung.text+
								'<div style="text-align:right;"><select class="einstellungsauswahl" id="setter_'+einstellung.id+'" size="1" onChange="Aktion_EinstellungBearbeiten(\''+einstellung.id+'\',this.options[this.selectedIndex].value);">'+
								'<option '+(einstellung.wert==true?'selected="selected" ':'')+'value="1">Ja</option>'+
								'<option '+(einstellung.wert==false?'selected="selected" ':'')+'value="0">Nein</option>'+
								'</select></div></p>');
				}
				document.getElementById("ausgabeeinstellungen").innerHTML = liste.join("<hr>");
			}
			function Anzeige_Hinweis(nachricht)
			{
				alert(nachricht);
			}
			function Button_Neustart(button)
			{
				if(!running || confirm('Aktuelles Spiel wirklich beenden?'))
				{
					SpielReset();
					Anzeige_Menu(['spiel_hauptmenu']);
				}
			}
			function Button_NachtWiederholen(button)
			{
				if (confirm('M√∂chtest du das Spiel zur√ºckspulen und die letzte Nacht erneut starten?'))
				{
					LadeSpeicherstand(speicherstand);
					running = true;
					Phasenwechsel();
				}
			}
			function Button_Fortsetzen(button)
			{
				if (confirm('Speicherstand am Beginn der letzten Nacht laden?'))
				{
					LadeSpeicherstand(localStorage.NWWA_Speicherstand);
					running = true;
					Anzeige_Menu(["spiel_guide","spiel_status","spiel_admin"]);
					Phasenwechsel();
				}
			}
			function Aktion_KartenZufallsliste()
			{
				kartenliste = new Array();
				while (!contains(kartenliste,"Werw√∂lfe")) //falls der Zufall alle Werw√∂lfe rauskickt
				{
					kartenliste = new Array();
					var klist = new Array();
					var kmap = new Object();
					for (var index in rollen)
					{
						for (var i=0; i<rollen[index].anzahl; i++)
						{
							var sortierer = Math.random().toString();
							kmap[sortierer] = rollen[index].name;
							klist.push(sortierer);
						}
					}
					klist.sort();
					for (var i=0; i<spieleranzahl; i++)
					{
						kartenliste.push(kmap[klist[i]]);
					}
				}
			}
			function Aktion_KartenVerteilen(spieler)
			{
				document.getElementById("kartenvergabe_spieler").innerHTML = "Spieler "+(spieler+1)+" von "+spieleranzahl;
				document.getElementById("karte").innerHTML =
					"<button style=\"float:right;\" class=\"listenbutton\" onclick=\"Aktion_KartenVerteilen("+((spieler+1)%spieleranzahl)+");\">&#9658;</button>"+
					"<button style=\"float:left;\"  class=\"listenbutton\" onclick=\"Aktion_KartenVerteilen("+((spieler+-1)%spieleranzahl)+");\">&#9668;</button>"+
					"<br><br><b>Rolle:</b><br><br>"+kartenliste[spieler]+"<br>";
			}
		</script>
	</head>
	<body onload="SpielInit();">
		<h1>NikosWerwolfWebApp</h1>
		<noscript><h1 style="color:#C00000;">ben√∂tigt Javascript!</h1></noscript>
		<fieldset id="spiel_hauptmenu" style="display:none;">
			<h2>Hauptmen√º</h2>
			<div class="zentriermich">
				<span style="font-size:0.9em;">Willkommen zur Werwolf&#8209;Spielleiter&#8209;Web&#8209;App!</span>
				<hr>
				<div id="continuebutton">
					<button class="blaubutton menubutton" onclick="Button_Fortsetzen(this);">Weiterspielen</button><br>
				</div>
				<button class="blaubutton menubutton" onclick="Anzeige_Menu(['spiel_setup']);">Neues Spiel</button><br>
				<button class="blaubutton menubutton" onclick="Anzeige_Menu(['spiel_anleitung']);">Anleitung</button>
				<hr>
				<button id="bugbutton" class="listenbutton menulistenbutton" onclick="window.open('https://github.com/n2code/werwolf/issues','_blank');">Bug melden (github)</button><br>
				<span style="font-size:0.9em;">Sonstiges Feedback oder anonyme Bugreports bitte an <br><span class="kontaktmail">ed.enilno2n@flowrew</span></span>
			</div>
		</fieldset>
		<fieldset id="spiel_setup" style="display:none;">
			<h2>Spiel-Setup</h2>
			<form id="vorbereitung_spieler" method="post" action="javascript:void(0);" onsubmit="return false;">
				<p>
					Spieler (<span id="spieleranzahl">0</span>):
				</p>
				<ul id="spielerliste"></ul>
			</form>
			<form id="vorbereitung_rollen" method="post" action="javascript:void(0);" onsubmit="return false;">
				<p>
					Rollen (<span id="rollenanzahl">0</span>):
				</p>
				<ul id="rollenliste"></ul>
			</form>
			<div class="zentriermich">
				Balance: <span id="balanceanzeige">0</span><br>
				<button class="blaubutton menubutton" onclick="SpielStart();">Spiel starten</button>
				<button class="listenbutton menulistenbutton" onclick="Anzeige_Menu(['spiel_einstellungen']);">Einstellungen</button>
				<button class="listenbutton menulistenbutton" onclick="Anzeige_Menu(['spiel_hauptmenu']);">&#9668; Hauptmen√º</button>
			</div>
		</fieldset>
		<fieldset id="spiel_guide" style="display:none;">
			<h2>Spiel</h2>
			<div id="ausgabe">
				<div id="ausgabecontent"></div>
				<div id="ausgabeinteraktion"></div>
			</div>
		</fieldset>
		<fieldset id="spiel_status" style="display:none;">
			<h2>Status</h2>
			<div id="statusausgabe"></div>
		</fieldset>
		<fieldset id="spiel_admin" style="display:none;">
			<h2>Spielleiter</h2>
			<div id="adminausgabe" style="text-align:center;">
				<button class="listenbutton menulistenbutton" style="width:250px;" onclick="Button_NachtWiederholen(this);">Spiel zur√ºckspulen</button>
				<button class="listenbutton menulistenbutton" style="width:250px;" onclick="Button_Neustart(this);">Spiel abbrechen</button>
			</div>
		</fieldset>
		<fieldset id="spiel_anleitung" style="display:none;">
			<h2>Anleitung</h2>
				<p style="font-size:0.8em;text-align:left;">
					Du traust dich, die Spielleiter-Rolle zu √ºbernehmen? Diese App nimmt dich an die Hand und assistiert dir! Ich gehe davon aus, dass du schon zumindest eine Partie gespielt hast, alles andere wissenswerte zum Spiel und zur App folgt jetzt.<br>
					<b>Vorsicht - Wall of Text!</b>
				</p>
				<hr>
				<h3>Voraussetzungen</h3>
				<p style="font-size:0.8em;text-align:left;">
					Damit Werwolf Spa&szlig; machen kann, sollte man mindestens 8 Spieler und 1 Spielleiter haben. Je besser sich die Personen kennen, desto spannender wird das Spiel. Namenskenntnis ist Minimum, Freude an Diskussionen optimal. Alle m√ºssen sich im Klaren dar√ºber sein, dass gelogen und betrogen wird, wo es nur geht... Zur Rollenverteilung werden zus√§tzlich entweder eine Spieleausgabe oder selbstangefertigte Zettel ben√∂tigt. Weiterhin sollte man in gem√ºtlicher Runde am Tisch oder im Kreis sitzen mit gen√ºgend Platz, damit du als Spielleiter drumherum laufen kannst.
				</p>
				<hr>
				<h3>Vorbereitung</h3>
				<p style="font-size:0.8em;text-align:left;">
					W√§hle im Hauptmen√º &quot;Neues Spiel&quot; und trage die Namen aller Mitspieler ein. Anschlie√üend f√ºge im unteren Teil gleichviele Rollen hinzu. Denk daran, dass Werw√∂lfe und mindestens genau so viele normale Dorfbewohner der Grundbestandteil des Spieles sind, zuviele andere Rollen bei zu wenigen Dorfbewohnern schaden. Sobald die Balance stimmt, kann es losgehn. In einer professionellen Runde kann man es mit bis zu -7 ruhig etwas schwerer machen, ansonsten sind Werte von -3 bis +3 vollkommen in Ordnung. Nur bei vielen absoluten Neulingen sind positivere Werte empfehlenswert.
				</p>
				<hr>
				<h3>Spiel: Bedienung</h3>
				<p style="font-size:0.8em;text-align:left;">
					Das Interface ist w√§hrend des Spiels dreigeteilt. Im Abschnitt &quot;Spiel&quot; steht der Text, den du als Spielleiter laut verk√ºndest, in Anf√ºhrungsstrichen. Fette Schrift kennzeichnet Aktionen die du ausf√ºhren oder anregen musst. Meist sind diese auch eingeklammert, lies diesen Teil *nicht* vor, sondern handle nur dementsprechend! Wenn die App eine Auswahl fordert, w√§hle je nach Aktion einen, mehrere oder auch gar keinen Spieler aus und best√§tige die Auswahl mit dem &quot;OK&quot;-Button. Im mittleren Abschnitt findest du Spielinfos f√ºr dich, diese sind vertraulich! Sie geben dir √úbersicht √ºber die Rollen der Spieler, ihre Beziehungen oder ihr Ableben. Weiterhin erf√§hrst du in der wievielten Tag- oder Nachtphase sich das Spiel befindet und wie lange diese bereits dauert.
				</p>
				<hr>
				<h3>Spiel: Sonderfunktionen</h3>
				<p style="font-size:0.8em;text-align:left;">
					Der unterste Abschnitt des Interface beinhaltet Sonderfunktionen f√ºr den Spielleiter (also dich^^). Die Buttons sollten selbsterkl√§rend sein und fragen bei Klick noch einmal nach, bevor sie sich aktivieren. Am interessantesten ist aber bestimmt der &quot;Zur√ºckspulen&quot;-Knopf: Zu Beginn einer jeden neuen Nacht wird das aktuelle Spiel automatisch gespeichert. Ist dir oder den Spielern ein schwerer Fehler unterlaufen, so kannst du die App auf den Anfang der letzten Nacht zur√ºcksetzen um Eingaben oder Entscheidungen zu korrigieren.
				</p>
			<div class="zentriermich">
				<hr>
				<button class="listenbutton menulistenbutton" onclick="Anzeige_Menu(['spiel_hauptmenu']);">&#9668; Hauptmen√º</button>
			</div>
		</fieldset>
		<fieldset id="spiel_einstellungen" style="display:none;">
			<h2>Einstellungen</h2>
			<p style="font-size:0.8em;text-align:left;">
				Hier in den erweiterten Spieleinstellungen k√∂nnen kleinere Regeldetails festgelegt werden, aber Vorsicht, die Balance wird dadurch unter Umst√§nden stark ver√§ndert!
			</p>
			<div class="zentriermich"><hr></div>
			<div id="ausgabeeinstellungen">
				<p>Loading...</p>
			</div>
			<div class="zentriermich">
				<hr>
				<button class="listenbutton menulistenbutton" onclick="Anzeige_Menu(['spiel_setup']);">&#9668; Zur√ºck</button>
			</div>
		</fieldset>
		<fieldset id="spiel_rollenvergabe" style="display:none;">
			<h2>Virtuelle Karten</h2>
			<div class="zentriermich">
				<span id="kartenvergabe_spieler">Spieler 0 von 0</span>
				
				<div id="karte"></div>
				<hr>
				<button class="listenbutton menulistenbutton" onclick="Anzeige_Menu(['spiel_guide']);">&#9668; Zur√ºck</button>
			</div>
		</fieldset>
		<div style="margin-top:-10px;font-size:0.7em;text-align:center;">NWWA<span id="vinfo"></span></div>
	</body>
</html>
